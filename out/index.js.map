{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["import MagicString, { SourceMap } from 'magic-string';\nimport { join, resolve } from 'path';\nimport rollup from 'rollup';\nimport { createFilter } from 'rollup-pluginutils';\n\ninterface Options {\n  include?: string | string[];\n  exclude?: string | string[];\n  shebang?: string;\n}\n\nconst plugin: rollup.PluginImpl<Options> = ({\n  include = ['**/cli.js', '**/bin.js'],\n  exclude,\n  shebang = '#!/usr/bin/env node',\n}: Options = {}) => {\n  const filter = createFilter(include, exclude) as (fileName: string) => boolean;\n\n  return { name: 'shebang',\n    renderChunk(code, { fileName }, { dir, file }) {\n      const outPath = dir ?\n        join(dir, fileName) :\n        file || fileName;\n\n      if (!filter(resolve(outPath))) { return null; }\n\n      const s = new MagicString(code);\n\n      s.prepend(`${shebang}\n\n`);\n\n      return {\n        code: s.toString(),\n        // Need to cast version, as it's declared string\n        // See: https://github.com/Rich-Harris/magic-string/pull/155\n        // (already merged, will be in next release)\n        map: s.generateMap({ hires: true }) as SourceMap & { version: number },\n      };\n    },\n  };\n};\n\nexport default plugin;\n"],"names":["plugin","include","exclude","shebang","filter","createFilter","name","renderChunk","code","fileName","dir","file","outPath","join","resolve","s","MagicString","prepend","toString","map","generateMap","hires"],"mappings":";;;;;;;;AAWA,MAAMA,MAAkC,GAAG,CAAC;EAC1CC,OAAO,GAAG,CAAC,WAAD,EAAc,WAAd,CADgC;EAE1CC,OAF0C;EAG1CC,OAAO,GAAG;IACC,EAJ8B,KAIvB;QACZC,MAAM,GAAGC,8BAAY,CAACJ,OAAD,EAAUC,OAAV,CAA3B;SAEO;IAAEI,IAAI,EAAE,SAAR;;IACLC,WAAW,CAACC,IAAD,EAAO;MAAEC;KAAT,EAAqB;MAAEC,GAAF;MAAOC;KAA5B,EAAoC;YACvCC,OAAO,GAAGF,GAAG,GACjBG,SAAI,CAACH,GAAD,EAAMD,QAAN,CADa,GAEjBE,IAAI,IAAIF,QAFV;;UAII,CAACL,MAAM,CAACU,YAAO,CAACF,OAAD,CAAR,CAAX,EAA+B;eAAS,IAAP;;;YAE3BG,CAAC,GAAG,IAAIC,WAAJ,CAAgBR,IAAhB,CAAV;MAEAO,CAAC,CAACE,OAAF,CAAW,GAAEd,OAAQ;;CAArB;aAIO;QACLK,IAAI,EAAEO,CAAC,CAACG,QAAF,EADD;;;;QAKLC,GAAG,EAAEJ,CAAC,CAACK,WAAF,CAAc;UAAEC,KAAK,EAAE;SAAvB;OALP;;;GAdJ;CAPF;;;;"}